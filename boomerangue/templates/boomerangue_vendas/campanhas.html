{% load sass_tags %}
{% load static %}
{% load tags %}
<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#FE4170">

<link rel="canonical" href="">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="apple-mobile-web-app-title" content="Boomerangue">
<link rel="apple-touch-icon" href="">
<link rel="manifest" href="{% url 'manifest' token=dados.token_bm %}">
 
<link rel="shortcut icon" href="{% static 'assets/images/logo/boomerangue.png' %}" type="image/x-icon"/>
 <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.2.0/css/bootstrap.min.css">



<title>{{dados.campanha.TextoPromocional}}</title>
</head>

<body>
<script src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<style>
			.tdf{
			position:relative;
}
		 .fa{
			width:150px;
			height:150px;
			position:absolute;
         	right:-1px;
         	top-10px;
         	display:flex;
         	justify-content:center;
         	align-items:center;
         	overflow:hidden;
		}
		.fa::before{
        	content:attr(data-content);
        	position:absolute;
        	width:250px;
        	height:40px;
        	background-color:#b71a3b;
        	transform:rotate(45deg) translateY(-20px);
        	box-shadow: 0 10px 15px rgba(0,0,0,.2);
        	display:flex;
        	justify-content:center;
         	align-items:center;
        	color:#fff;
        	font-weight:500;
        	
        }
		.fa::after{
        	content:'';
        	position:absolute;
        	width:10px;
        	height:10px;
        	bottom:0;
            right:0;
        	background-color:#7e0f12;
        	z-index:-1;
        }
		#fa::before{
		background-color:#3a8339;
		}
		#fa::after{
		background-color:#287128;
		}
	</style>

<script>
var tokenUser='';
function enviaToken(token){
	var data = {
			userToken: token
		};
		fetch('{% url "send_token" %}',{
			method:"POST",
			headers: {
			'Content-Type': 'application/x-www-form-urlencoded',
			},
			body: new URLSearchParams(data)
		}).then((res)=>res.json())
		.then(data=>{
			console.log("Token Enviado!")
		})
	}
function cadastroTopic(token){
		var url = window.location.hostname; // obtém o nome do host da URL
		var parts = url.split('.'); // divide a URL em partes
		var subdomain = parts[0]; // pega a primeira parte da URL que é o subdomínio

		var data = {
			userToken: token,
			prefixo:subdomain
		};
		fetch('{% url "cadastro_topic" %}',{
			method:"POST",
			headers: {
			'Content-Type': 'application/x-www-form-urlencoded',
			},
			body: new URLSearchParams(data)
		}).then((res)=>res.json())
		.then(data=>{
			console.log("Topico cadastrado!")
		})
    }
if ("serviceWorker" in navigator) {
 if (navigator.serviceWorker.controller) {
 console.log("[PWA Builder] active service worker found, no need to register");
 } else {
 // Register the service worker
 navigator.serviceWorker
 .register("/pt/pwabuilder-sw.js", {
 scope:"./"
 })
 .then(function (reg) {
 console.log("[PWA Builder] Service worker has been registered for scope:"+reg.scope);
 });
 }
}

</script>
    <!-- Navigation -->
    <div class="w-100 faixa fixed-top"></div>
    <nav class="navbar navbar-expand-lg navbar-light fixed-top mb-3">
    <div class="container">
        <div class="d-flex col-md-6 col-11 align-items-center">
    		<div class='d-block d-lg-none'>
    			<img class="mt-0 ms-0" height="26" width="32" alt="loginho"  src="assets/img/logo/logo1.png">
    		</div>
            <div class="col-lg-11 p-lg-0 col-md-12 col-11 ">
            	<a class="navbar-brand " id="titu2" href="#">{{dados.template.TextoHeader}}</a>
            </div>
			<div class="col-md-12  col-lg-8 text-center   align-items-center" id="ola">
                <ul>
                	<li><a class="float-end mbs pe-md-5 pe-auto" href="">Campanhas</a></li>
                	<li><a class="mbs float-start" href="/meus_pedidos/{{dados.token_bm}}">Meus Pedidos</a></li>    
                </ul>
               
            </div>
        
            <input type="checkbox" id="btMenu">
        	<label for="btMenu" onclick="checado()" id="men"><i class="bi bi-list"></i></label>
        </div>
            <img id="logo" class="d-none d-lg-block" alt="Boomerangue" src="{% static 'assets/images/logo/boomerangue_logo3.png' %}">
    </div>
    </nav>
   <div class="container" onclick="fechar();" style="margin-top: 13vh;">
	<div class="row">
        		          
     		     		     		     	
            <div class="col-12">     			
      			<div class="">
            	<div class="d-flex">
            		<div class="col-md-5 col-8">
            			<div class="">
     						<span class="border-0 pr-0">Cliente</span><br>
            				<p class="fw-bolder">{{dados.entidade.Entidade}}</p>
                			
            			</div>
            		</div>
            		<div class="col-md-4 col-lg-5 col-3 ms-md-0 ms-2">
                		<div class="">
                            {% with dados.entidade.CNPJ|remove_non_numeric as cnpj_numerico %}
							{% if cnpj_numerico|length == 11 %}
								<script>
									var testt=1;
								</script>
								<span class="border-0 pe-0">CPF</span><br>
							{% else %}
								<span class="border-0 pe-0">CNPJ</span><br>
							{% endif %}
							<p id="cpfcnpj" class="fw-bold ">{{ cnpj }}</p>
						{% endwith %}
                		</div>
         			            	
        <a href="">
       		<img class="d-md-block d-none imgmarket" width="200" height="100"  src="/media/{{dados.template.image_footer}}">
         </a>               
  	</div>
        </div>
             
       <div class="mt-3 d-flex flex-md-row  flex-column mb-0">
       		<div class="col-md-7 mt-md-0 mt-3 text-danger fw-bold col-12 order-md-first order-last" style="font-size:1.3em;"><p>Campanhas</p></div>
       		<div class="col-md-3 col-12 mt-md-0 mt-2">
    			<button class="btn col-12 appDown" type="button" id="enable-banner-install"><i class="bi bi-file-earmark-arrow-down"></i> Instalar Boomerangue</button>
    		</div>
        	
                <div class="col-md-2 col-12 ms-md-1 ms-0 order-md-last order-first">
                	<a class="btn col-12 vto" href="/oferta/{{dados.token_bm}}"><i class="bi bi-arrow-left"></i>Voltar para oferta</a>
                </div>
       </div>
       <hr class="corlinha mt-0">
 <div class="row justify-content-start mb-0"> 
	{% for campanha in campanhas %}
   	<div class="mt-md-0 mt-3 col-md-4 col-lg-3 col-6 tdf">
	
  		<span class='fa' id="{% if agora < campanha.data_final_campanha %}fa{% elif campanha.bm_aceito == 'S' %}fa{% else %}{% endif %}" data-content="{% if campanha.bm_aceito == 'S' %}Comprou{% elif campanha.data_final_campanha > agora %}Em andamento{% else %}Encerrada{% endif %}"  ></span> 
		<div class="linhaa">
			<div class="inform" style="height:370px;">
				<a href="/pt/oferta/{{campanha.token_bm}}" id="prdt" style="height:300px;">
					<div class="cat text-center mb-1">
						<img class="imp" loading="lazy" alt="imagem nestle" src="/media/{{campanha.ImageBannerMobile}}">
					</div>
					<p class="ddesc" style="font-weight:600;">{{campanha.campanha.TextoPromocional}}</p>
  					<p class="sku d-flex w-100 mt-1">Nº Pedido: {{campanha.chave_busca}}</p>
                    <p class="sku d-flex w-100">Data Envio: {{campanha.data_pri_envio|date:'d/m/Y H:m:i'}}</p>
					<p class="sku d-flex w-100">Encerramento: {{campanha.campanha.data_fim|date:"d/m/Y"}} às {{dados.campanha.horario_fim}}</p>
                    <p class="sku d-flex w-100">Total Pedidos: R$ {{campanha.valor_atual|custom_floatformat:2}}</p>
                    <p class="sku d-flex w-100">Distribuidor: </p>
        		</a>
			</div>
			<div class="price-box mb-lg-0 mb-2 ">
         		<div class="price1">
        	
        		
        	
       			</div>
       
     		</div>
   
		</div> 
	</div>
	{% endfor %}
    	<div class="col-12 d-flex justify-content-center text-center">
    		<h5>Não há campanhas no momento. Aproveite para descansar e, em breve, uma nova campanha para você.</h5>	
    	</div>
</div>
    
    <div class="row d-md-none d-flex justify-content-center mt-5" id="y">
        <div class="me-5 col-12 ms-5 cnt mt-0">
            <div class="mt-0">
                <div class="row justify-content-between d-flex align-items-center">                       
                        <a href="{{dados.template.link_footer}}" aria-label="Cadastre-se" target="_blank"  class="d-flex flex-wrap align-items-center imgmarket ms-lg-5">
                            <img class="imgmarket" loading="lazy" alt="cadastre-se" width="200" height="100" src="<?php echo BASE_URL; ?>assets/img/logo/imagem_marketing1.png">
                        </a>
                      
                </div>
           </div>

     	</div>
    </div>
  		              
                
              
  <footer class="bg-img-repeat mt-2 foot" id="foot">
    <div class="page-header-ui-content">
            <div class="container px-5">
                <div class="row gx-5 justify-content-center">
                    <div class="col-12 text-center">
                        <h6 class="page-header-ui-title">© 2024 - Boomerangue. All rights reserved.</h6>
                    </div>
                </div>
            </div>
        </div>
    </footer>
  </div>   
       
       
       
       
       
       
<link rel="preload" as="style" onload="this.onload=null;this.rel='stylesheet'" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css">
<link rel="stylesheet" href="{% static 'assets/css/testi.css'%}" >
<link rel="stylesheet" href="{% static 'assets/css/indexi.css' %}" >
<script src="{% static 'assets/js/mobile_menu.js' %}"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SXJE0BPHF6"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js" integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>
<script type='module' src="{% static 'assets/js/firebase.js' %}"></script>
	
    <script>
	const csrftokenCookie = document.cookie.split(';').find(cookie => cookie.trim().startsWith('csrftoken='));
	// Extrai o valor do csrftoken do cookie
	const csrftoken = csrftokenCookie ? csrftokenCookie.split('=')[1] : null;


    $(document).ready(function() {
    	instaled(ins="OPENCM");	
	});
    
	$('#prdt').on('click',function(){
    	instaled(ins="CLICCM");
    })
	document.addEventListener(visibilityEvent, function(event) {
  	if (!document[hidden]){
  			instaled(ins='OPENCM');
  	} else {
  		instaled(ins='CLOSECM');
  	}
	});
    
	function instaled(ins,chave){
    	var keygoo=''
    	if(chave!=""){
        	keygoo=chave;
        }
    	fetch('/pt/api/log_bmm/',{
			method:"POST",
			headers: {
			'Content-Type': 'application/json',
			'X-CSRFToken': csrftoken,
			},
			body:JSON.stringify({
				tipolog_id: 'B',
				acao_id:ins,
				boomerangue: '{{dados.pk}}',
				entidade_id:'{{dados.entidade.pk}}',
				Token: '{{dados.token_bm}}',
				Telefone: '{{dados.entidade.Telefone1}}',
				Complemento2: keygoo,


				
			})
		}).then((res)=>res.json())
		.then(data=>{
			console.log(data)
		})

    }
    
    let deferredPrompt;
    const addBtn = document.querySelector('#enable-banner-install');
	// verifica se o site esta aberto pelo app
    function isRunningStandalone() {
    return (window.matchMedia('(display-mode: standalone)').matches);
	}
	if (isRunningStandalone()) {
   		addBtn.style.display = 'none';	
	}
    window.addEventListener('appinstalled', () => {
  	// If visible, hide the install promotion
    		var ins='UINTI';
    		instaled(ins);
  // Log install to analytics
  		console.log('INSTALL: Success');
		});
    window.addEventListener('beforeinstallprompt', (e) => {
        console.log('beforeinstallprompt...');
        addBtn.style.display = 'block';
        e.preventDefault();
        deferredPrompt = e;
        addBtn.addEventListener('click', (e) => {
            addBtn.style.display = 'none';
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choiceResult) => {
                if (choiceResult.outcome === 'accepted') {
                    console.log('User accepted the prompt');
                	instaled(ins='CLICCI');
                    
                } else {
                    console.log('User dismissed the prompt');
                }
                deferredPrompt = null;
            });
        });
    });
	window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-SXJE0BPHF6');
       
    </script>
       
       
   </body>
</html>