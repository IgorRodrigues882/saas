<!-- Chart widget top Ends-->
<style>
  .text-white {
    color: white;
}
</style>
{% load static %}
{% load sass_tags %}
<div class="col-xl-12">
<div class="card ongoing-project recent-orders">
  <div class="card-header card-no-border">
    <div class="media media-dashboard">
      <div class="media-body">
        <h5 class="mb-0">Itens</h5>
      </div>
      <div id="scrollable-dropdown-menu" class="me-3 d-flex align-items-center">
        <div class="me-3">
            <input class="typeahead form-control" type="text" placeholder="Pesquisar...">
            <div class="input-group-append">
              <span class="loading-indicator-3 input-group-text text-primary" style="display: none;"><i class="fa fa-spin fa-spinner"></i></span>
            </div>
        </div>
        <a class="btn btn-secondary" data-bs-toggle="modal" id="criar_template_item_btn" data-bs-target="#criar_template_item">
          Criar mensagem
        </a>
      </div>
       
      
    </div>
  </div>
  <div class="card-body pt-0">
    <div class="table-responsive">
      <table class="table table-bordernone" id="item-table3">
        <thead>
          <tr>
            <!-- <th><span>ID</span></th> -->
            <th><span>Descrição Produto</span></th>
            <th><span>Valor Atacado</span></th>
            <th><span>Valor Unitário</span></th>
            <th><span>Valor Total Item</span></th>
            <th><span>Unidade Caixa</span></th>
            <th><span>Unidade Venda</span></th>
            <th><span>Produto Bloqueado</span></th>
            <th><span>Arquivo de Origem</span></th>
          </tr>
        </thead>
        <tbody>
          {% for item in items.items %}
          <tr>
            <!-- <td>{{item.pk}}</td> -->
            <td>
              <div class="media">
                <div class="square-box me-2"><img src="{{item.produto.PathProduto}}" onerror="this.onerror=null;this.src='{% static 'assets\images\banner\Produto-sem-foto.png' %}';"  style="width: 100%; height: 100%; object-fit: contain;"/></div>
                <div class="media-body ps-2">
                  <div class="avatar-details"><a href="/">
                      <h6>{{item.produto.Descricao}}</h6>
                    </a><span>{{item.produto.pk}}</span></div>
                </div>
              </div>
            </td>
            <td class="img-content-box">
              <h6>{{item.valor_atacado|floatformat:2}}</h6>
            </td>
            <td>
              <h6>{{item.valor_unitario|floatformat:2}}</h6>
            </td>
            <td style="width: 100px;">
              <h6>{{item.valor_total_item}}</h6>
            </td>
            <td>
              <h6>{{item.unidade_caixa}}</h6>
            </td>
            <td>
              <h6>{{item.unidade_venda}}</h6>
            </td>
            <td>
              <h6><span class="badge {% if item.produto_bloqueado == 'N' %} badge-success {% else %} badge-danger {% endif %} text-white">{{item.produto_bloqueado}}</span></h6>
            </td>
            <td>
              <h6>{{item.templateimportado.NomeArquivo}}</h6>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
      <div class="loader-box" id="loader3" style="display: none;">
        <div class="loader-2"></div>
      </div>
    </div>
  </div>
  
</div>


<div class="modal fade modal-bookmark" id="criar_template_item" tabindex="-1" role="dialog"
aria-labelledby="exampleModalLabel" aria-hidden="true">
<div class="modal-dialog modal-lg" role="document">
  <div class="modal-content">
    <div class="modal-header">
      <h5 class="modal-title" id="exampleModalLabel">Criar Template de Mensagemd231</h5>
      <button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
    </div>
    <div class="modal-body">
      <form class="form-bookmark needs-validation" id="create_item_form" novalidate="">
        
        <!--<div class="row g-2">
          <div class="col-sm-12">
            <div class="card">
              <div class="card-body">

                <div class="mb-3">
                  <label class="control-label">Whatsapp Template</label>
                  <select class="js-example-basic-single" type="text" name="wpptemplate" id="select_wpp_templates" required="required">
                    <option value="">Selecione uma opção</option>
                    {% for wpp_template in wpp_templates %}
                      <option value="{{ wpp_template.id }}">{{ wpp_template.template_name }}</option>
                    {% endfor %}
                  </select>
                </div>

                <div class="mb-3">
                  <label class="control-label">Uso Template</label>
                  <select class="form-control" type="text" name="usotemplate" id="usotemplate" required="required">
                    <option value="OPTIN">Optin</option>
                    <option value="ENVIO">Envio</option>
                  </select>
                </div>

                <button class="btn btn-secondary" type="button" id="salvar_template_mensagem" onclick="criarTemplateMessages()">Salvar</button>
                <button class="btn btn-primary" type="button" data-bs-dismiss="modal">Cancelar</button>
                
              </div>
            </div>
          </div>
        </div>-->

        {% csrf_token %}
        <div class="card">
          <div class="card-body">
          
            <div class="mb-3">
              <label for="boomerangue">Boomerangue:</label>
              <select name="boomerangue" id="boomerangue" class="form-control">
                <option value="">Selecione uma opção</option>
                {% for boomerangue in items.boomerangues %}
                  <option value="{{ boomerangue.id }}">{{ boomerangue.campanha_nome }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="mb-3">
              <label for="campanha">Campanha:</label>
              <select name="campanha" id="campanha" class="form-control">
                <option value="">Selecione uma opção</option>
                {% for campanha in items.campanhas %}
                  <option value="{{ campanha.id }}">{{ campanha.Campanha }}</option>
                {% endfor %}
              </select>
            </div>

            <div class="mb-3">
              <label for="produto">Produto:</label>
              <select name="produto" id="produto" class="form-control" onchange="document.querySelector('#produto_original_id').value=this.value">
                <option value="">Selecione uma opção</option>
                {% for produto in items.produtos %}
                  <option value="{{ produto.id }}">{{ produto.Descricao_Amigavel }}</option>
                {% endfor %}
              </select>
              <input type="hidden" id="produto_original_id" name="produto_original_id" />
            </div>

            <div class="mb-3">
              <label for="template">Template:</label>
              <select name="template" id="template" class="form-control">
                  <!-- Add options dynamically based on your data -->
                  <option value="{{ items.template.id }}">{{ items.template.nome_template }}</option>
              </select>
            </div>
            
            <div class="mb-3">
              <label for="unidade_venda">Unidade Venda:</label>
              <input type="text" name="unidade_venda" id="unidade_venda" class="form-control">
            </div>
            
            <!--
            <div class="mb-3">
              <label for="templateimportado">Template Importado:</label>
              <select name="templateimportado" id="templateimportado" class="form-control">
                {% for csv_importado in csv_importados %}
                  <option value="{{ csv_importado.id }}">{{ csv_importado.NomeArquivo }}</option>
                {% endfor %}
              </select>
            </div>
            -->

            <button type="button" class="btn btn-secondary" onclick="criarTemplateItem()">Criar</button>
          </div>
        </div>


      </form>
    </div>
  </div>
</div>
</div>


</div>

